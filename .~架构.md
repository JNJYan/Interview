<!--

 * @Author: JNJYan
 * @LastEditors: JNJYan
 * @Email: jjy20140825@gmail.com
 * @Date: 2020-07-09 14:13:08
 * @LastEditTime: 2020-07-09 14:51:08
 * @Description: Modify here please
 * @FilePath: /Interview/架构.md
--> 
[TOC]
# 架构的目的
主要目的是为了解决软件复杂度带来的问题，复杂度的来源有：高性能、高可用、可拓展、低成本、安全、规模。

## 高性能

## 高可用
计算高可用、存储高可用

状态决策：独裁式、协商式、民主式

ZooKeeper选举算法Paxos

民主式决策固有缺陷：脑裂现象，原来统一的集群因为连接中断，造成两个独立分割的子集群。

## 可拓展

## 低成本
1. NoSQl(Memcache, Redis)的出现是为了解决关系型数据库无法应对高并发访问带来的访问压力。
2. 全文搜索引擎(Elasticsearch)的出现是为了解决关系型数据库like搜索的低效问题。
3. Hadoop的出现是为了解决传统文件系统无法应对海量数据存储和计算的问题。

## 安全
1. 功能安全
2. 架构安全

## 规模
量变引起质变，功能增多，系统复杂度指数级上升。数据增多，系统复杂度发生质变。

# 架构设计三原则
## 合适原则
“合适优于业界领先”

## 简单原则
简单优于复杂

复杂性体现在两个方面

**结构复杂性**：复杂系统的组件数量更多，组件之间的关系更加复杂。

**逻辑复杂性**：单个组件承担太多功能。

## 演化原则
演化优于一步到位

## 案例
### 阿里
1. 买个轻量级网站，二次开发
主从MySQL

2. Oracle/支付宝
Oracle+NAS(Network Attached Storage，网络附属存储)+Oracle RAC(Real Application Clusters，实时应用集群实现负载均衡)。

3. PHP->JAVA1.0

4. Java2.0
分库、引入Spring、缓存、CDN、开源JBoss

5. Java3.0/分布式
自研

### 手机QQ
用户规模
1. 十万级
存储服务器<-->接入服务器

2. 百万级
存储集群<-->接入集群
状态同步服务器、长连接集群

3. 千万级
千万级时产生问题：
- 同步流量太大，状态同步服务器单机瓶颈
- 在线用户信息量太大，单台接入服务器村放不下
- 单台状态同步服务器放不下所有在线用户
- 单台接入服务器支撑不住所有在线用户的在线状态信息。

4. 亿级
  重新设计

  ![image-20200709145140732](C:\Users\May\AppData\Roaming\Typora\typora-user-images\image-20200709145140732.png)